---
title: "R Notebook"
output: html_notebook
---

```{r}
library(readxl)
library(tidyverse)
library(fixest)
```


```{r}
beer <- read_excel("data-raw/beer.xlsx")  %>% 
  rename(cust_id = id, date = data, 
         hhsize = wielkosc_gosp, education = wyksztalcenie, region = wojewodztwo, place_type = sklepy, count = sztuki) %>%
  select(-rok, -miesiac) %>%
  mutate(place_type = case_when(place_type == "Dyskont"  ~ "Discount",
place_type == "Sklepy Spozywcze"  ~ "Grocery",
place_type == "Hypermarkets"  ~ "Hypermarkets",
place_type == "Sieci Detal"  ~ "Retail networks",
place_type == "Hurt"  ~ "Wholesale",
place_type == "Supermarkets"  ~ "Supermarkets",
place_type == "Sklepy Firmowe"  ~ "Company stores",
place_type == "Inny Sklep"  ~ "Other shop",
place_type == "Stacje Benzynowe"  ~ "Gas stations",
place_type == "Sklep Monopolowy"  ~ "Liquor store",
place_type == "Kiosk Drogeria Ksiegarnia"  ~ "Kiosk Bookstore",
place_type == "Pozostale"  ~ "Other",
place_type == "Internet"  ~ "Internet"))

writexl::write_xlsx(x = beer, format_headers = T, path = "data-raw/beer-eng.xlsx")

```


```{r}
beer <- beer %>% add_count(cust_id) %>% filter(n > 1) %>%
  mutate(month = substr(date, 5,6))

beers_nb <- fenegbin(fml = count ~ place_type | cust_id  + month,  data = beer)
beers_nb_nc <- MASS::glm.nb(formula =  count ~ place_type, data = beer)
summary(beers_nb_nc)
summary(beers_nb)
```



